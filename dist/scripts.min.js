let pokemonRepository = (function () {
  let t = [],
    e = $(".pokemon-list");
  function n(e) {
    t.push(e);
  }
  function o() {
    return t;
  }
  function i(t) {
    return fetch(t.detailsUrl)
      .then(function (t) {
        return t.json();
      })
      .then(function (e) {
        (t.imageUrl = e.sprites.front_default),
          (t.height = e.height),
          (t.types = e.types.map((t) => t.type.name)),
          (t.abilities = e.abilities.map((t) => t.ability.name));
      })
      .catch(function (t) {
        console.error(t);
      });
  }
  function a(t) {
    return t.charAt(0).toUpperCase() + t.slice(1);
  }
  function l(t) {
    i(t).then(function () {
      p(t);
    });
  }
  function p(t) {
    var e;
    let n = $(".modal-body"),
      o = $(".modal-title");
    n.empty(), o.text(a(t.name));
    let i,
      l,
      p = $(
        "<p>Height: " +
          ((l = Math.floor((i = (e = t.height) / 10) / 0.0254)),
          `${i}m (${Math.floor(l / 12)}' ${l % 12}")`) +
          "</p>"
      ),
      s = $('<img class="pokemon-img" src="' + t.imageUrl + '" />'),
      r = $("<p>Types: " + a(t.types[0]) + ", " + t.types[1] + "</p>"),
      c = $(
        "<p>Abilities: " + a(t.abilities[0]) + ", " + a(t.abilities[1]) + "</p>"
      );
    n.append(s), n.append(p), n.append(r), n.append(c);
  }
  return {
    add: n,
    getAll: o,
    addListItem: function t(n) {
      let o = $('<li class="list-group-item"></li>'),
        i = $(
          '<button class="pokemon-button btn btn-info" data-target="#pokemon-modal" data-toggle="modal">' +
            a(n.name) +
            "</button>"
        );
      o.append(i),
        e.append(o),
        i.on("click", function () {
          l(n);
        });
    },
    loadList: function t() {
      return fetch("https://pokeapi.co/api/v2/pokemon/?limit=30")
        .then(function (t) {
          return t.json();
        })
        .then(function (t) {
          t.results.forEach(function (t) {
            n({ name: t.name, detailsUrl: t.url });
          });
        })
        .catch(function (t) {
          console.error(t);
        });
    },
    loadDetails: i,
    showDetails: l,
    showDetailsModal: p,
  };
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (t) {
    pokemonRepository.addListItem(t);
  });
});
